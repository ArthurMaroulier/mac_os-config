#! /usr/bin/env bash

# DESCRIPTION
# Applies basic system settings.

# EXECUTION
printf "Applying basic settings...\n"

source "$MAC_OS_CONFIG_PATH/lib/settings.sh"

# Set clean_response to false by default
clean_response=false
mac_os_label=""
mac_os_name=""

# Clean the default directories
printf "Cleaning default directories (this will delete everything that is the folders)...\n"
for directory in "${DEFAULT_DIRECTORIES[@]}"
do
  read -p "Do you want to clean the $directory folder? (y/n) " clean_response
  if [[ $clean_response =~ ^([yY][eE][sS]|[yY])$ ]]; then
    rm -rf $HOME/$directory/*
  fi
  clean_response=false
  printf "\n"
done

# Set system label and name
while [[ -z "$mac_os_label" ]]
do
  read -p "What is this machine's label (Example: \"Alchemist\")? " mac_os_label
done

while [[ -z "$mac_os_name" ]]
do
  read -p "What is this machine's name (Example: \"alchemist\")? " mac_os_name
done

printf "Setting system label and name...\n"
sudo scutil --set ComputerName $mac_os_label
sudo scutil --set HostName $mac_os_name
sudo scutil --set LocalHostName $mac_os_name
sudo defaults write /Library/Preferences/SystemConfiguration/com.apple.smb.server NetBIOSName -string $mac_os_name

# Set desktop image
printf "Setting default desktop image (3200x2000@300).\n"
sudo cp "$MAC_OS_CONFIG_PATH/lib/images/desktop_background.jpg" $HOME/Documents/default.jpg
