#! /usr/bin/env bash

# DESCRIPTION
# Installs App Store applications.

source "$MAC_OS_CONFIG_PATH/lib/settings.sh"

# Check if brew and mas are installed
has_brew=$(command -v brew)

if [ -z "$has_brew" ] ; then
  printf "Homebrew can't be found, installation of Homebrew...\n"
  ruby -e "$(curl --location --fail --silent --show-error https://raw.githubusercontent.com/Homebrew/install/master/install)"
  export PATH="/usr/local/bin:$PATH"
fi

has_brew=$(command -v brew)
has_mas=$(command -v mas)

if [ ! -z "$has_brew" -a -z "$has_mas" ] ; then
  printf "Mac App Store CLI (mas) can't be found, installation of mas...\n"
  eval "brew install mas"
fi

has_mas=$(command -v mas)

if [ ! -z "$has_mas" ] ; then
  # Install Mac App Store apps
  printf "Install Apps from the Mac App Store...\n"
  for mas_app in "${MAS_APPS[@]}"
  do
    eval "mas install $mas_app"
  done
else
  printf "Mac App Store CLI (mas) can't be found, Mac App Store applications won't be installed.\n"
fi